<!doctype html>
<html>
  <head><meta charset="utf-8" /><title>Encrypted Voting Demo</title></head>
  <body>
    <h1>Encrypted Voting â€” Demo</h1>
    <button id="connect">Connect Wallet</button>
    <div><button id="register">Register</button></div>
    <div>
      <input id="cipher" placeholder="Type fake ciphertext e.g. voteA" />
      <button id="submit">Submit Encrypted Vote</button>
    </div>

    <script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js" type="application/javascript"></script>
    <script>
      const contractAddress = "<PASTE_DEPLOYED_CONTRACT_ADDRESS>";
      const abi = [
        "function register() public",
        "function submitEncryptedVote(bytes calldata) public",
      ];

      let provider, signer, contract;

      document.getElementById('connect').onclick = async () => {
        if (!window.ethereum) { alert("Install MetaMask"); return; }
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        contract = new ethers.Contract(contractAddress, abi, signer);
        alert("Connected");
      };

      document.getElementById('register').onclick = async () => {
        if (!contract) return alert("Connect wallet first");
        await contract.register();
        alert('Registered (tx sent)');
      };

      document.getElementById('submit').onclick = async () => {
        if (!contract) return alert("Connect wallet first");
        const text = document.getElementById('cipher').value || "voteA";
        const bytes = ethers.utils.toUtf8Bytes(text);
        const tx = await contract.submitEncryptedVote(bytes);
        await tx.wait();
        alert('Submitted (tx mined)');
      };
    </script>
  </body>
</html>
